<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<style>
.button {
  background-color: #4CAF50;
  border: none;
  color: white;
  padding: 15px 25px;
  text-align: center;
  font-size: 16px;
  cursor: pointer;
}

.button:hover {
  background-color: green;
}
circle {fill: lightblue; stroke: black;}
</style>
<script src='https://d3js.org/d3.v5.min.js'></script>
<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>
</head>
<body onload="init()">
<div>
  <button class="button" onclick="init()">LifeExpectancyMale</button>
  <button class="button">LifeExpectancyRegion</button>
  <button class="button">LifeExpectancy</button>
</div>
<!--label>
  Group
  <select class="group-select">
    <option value=1 selected>1</option>
    <option value=2>2</option>
    <option value=3>3</option>
  </select>
</label-->
<div>
<svg width="600" height="600">
</div>
<script>
async function init() {
  const data = await d3.csv("https://maya-jha.github.io/data/wdi_mod.csv");
  margin = 100;
  height = 500;
  width = 500;
  maxRadius=10
  // setup x
//var xValue = function(d) { return d.HealthExpCapita;}, // data -> value
//xDomain = [d3.min(data, xValue)-1, d3.max(data, xValue)+1];
xDomain = [2, 1024]
yDomain = [30, 100]
xScale = d3.scaleLinear().domain(xDomain).range([0, width]) // value -> display
var rValue = function(d) { return parseInt(d.PopulationTotal);}, // data -> value
rDomain = [d3.min(data, rValue)-1, d3.max(data, rValue)+1];
rScale = d3.scaleLog().base(2).domain(rDomain).range([0,maxRadius]) // valu

// setup y
    yScale = d3.scaleLinear().domain(yDomain).range([height, 0]) // value -> display
    //yAxis = d3.svg.axis().scale(yScale).orient("left");
  var svg = d3.select("svg")
              .append("g")
              .attr("transform", "translate(" + margin / 2 + "," + margin / 2 + ")");
  svg.selectAll("circle")
    .data(data)
    .enter()
    .append("circle")
    .filter(function(d) { return d.Year == "12/1/00" })
    .attr('cx',function(d,i) {return xScale(d.HealthExpCapita.trim().replace("$", ""));})
        .attr('cy',function(d, i) { return yScale(d.LifeExpectancyMale); })
        .attr('r', function(d, i) { return rScale(d.PopulationTotal) })

   d3.select("svg")
  .append("g")
  .attr("transform", "translate(" + margin / 2 + "," + margin / 2 + ")")
  .call(d3.axisLeft(yScale).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")))

  // text label for the y axis
svg.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "end")
    .attr("y", -30)
    .attr("x", -50)
    .attr("dy", ".75em")
    .attr("transform", "rotate(-90)")
    .text("life expectancy (years)");

  d3.select("svg")
      .append("g")
      .attr("transform", "translate(" + margin / 2 + "," + (height + margin / 2) + ")")
      .call(d3.axisBottom().scale(xScale).tickValues([10, 100, 1000, 10000]).tickFormat(d3.format("~s")));

  // text label for the x axis

 svg.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "end")
    .attr("x", width)
    .attr("y", height - 6)
    .text("Health ExpCapita");
    const annotations = [{
  note: { label: "Hi"},
  x: 200, y: 200,
  dy: 137, dx: 162,
  subject: { radius: 50, radiusPadding: 10 }
}]

const makeAnnotations = d3.annotation().annotations(annotations)
svg.append("g")
  .attr("class", "annotation-group")
  .call(makeAnnotations)
}
</script>
</body></html>
